<!DOCTYPE html>
<html>

<head>
    <title>Nail-Biting Feedback</title>
    <link rel="apple-touch-icon" sizes="180x180" href="img/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="img/favicon-16x16.png">
<link rel="manifest" href="img/site.webmanifest">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/sankey.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <link href="index.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Open Sans' rel='stylesheet'>
    <style>
        body {
            font-family: 'Open Sans';
        }
    </style>
</head>

<body>
    <figure class="highcharts-figure">
        <div id="container"></div>
        <h3>Hover over the relevant links to view feedback tailored to your needs. You can <strong>click or unclick multiple nodes</strong> based on your specific cases.</h3>
        <div>
            <h3>1. Can you self-control your nail-biting?</h3>
        </div>
        <div>
            <h3>2. Do you want feedback related to physical intervention (e.g., installing an object to hide nails)?
            </h3>
        </div>
        <div>
            <h3>3.1 Do you want the feedback increase the awareness?</h3>
        </div>
        <div>
            <h3>3.2 Do you want the feedback can be a distraction?</h3>
        </div>
        <div>
            <h3>3.3 Do you want strong feedback or mild feedback?</h3>
        </div>
    </figure>
    <script>

        // Store original colors
        const originalColors = {};
        const chart = Highcharts.chart('container', {
            chart: {
                marginRight: 45, // allows the yAxis labels with (x: 30) to be seen, but reduces navigator size
            },
            title: {
                text: 'Feedback Suggestion for Suppressing Nail-Biting'
            },

            subtitle: {
                text: 'Understanding Traits of Individuals with Nail-Biting to Explore the Design Space for Multimodal Behavior Feedback'
            },
            accessibility: {
                point: {
                    valueDescriptionFormat: '{index}. {point.from} &#10132; {point.to}, {point.weight}.'
                }
            },
            tooltip: {
                headerFormat: null,
                pointFormat:
                    '{point.from} &#10132; {point.to}',
                nodeFormat: '{point.name}'
            },
            series: [{
                keys: ['from', 'to', 'weight', 'color', 'states'],
                nodes: [
                    {
                        id: 'Yes',
                        color: '#A6CF98',
                    },
                    {
                        id: 'No',
                        color: '#FF6969'
                    },
                    {
                        id: 'Self-control',
                        color: '#f5f7fa'
                    },
                    {
                        id: 'Physical intervention',
                        color: '#f5f7fa' // Another Orange color
                    },
                    {
                        id: 'Awareness',
                        color: '#f5f7fa' // Blue color
                    },
                    {
                        id: 'Distraction',
                        color: '#f5f7fa',
                    },
                    {
                        id: 'Want Strong Feedback',
                        color: '#f5f7fa',
                    },
                    {
                        id: 'EMS Tingling Sensation',
                        color: '#073b4c',
                    },
                    {
                        id: 'Pneumatic Finger Band',
                        color: '#06d6a0',
                    },
                    {
                        id: 'Vibration',
                        color: '#ef476f',
                    }
                    , {
                        id: 'Pneumatic Balloon',
                        color: '#ffd166',
                    },
                    {
                        id: 'EMS Actuation',
                        color: '#118ab2',
                    }
                ],
                data: [
                    {
                        id: 'id1',
                        from: 'Self-control',
                        to: 'Yes',
                        weight: 30,
                        color: '#ed5565',
                        events: {
                            mouseOver: function () {
                                this.setState('hover');
                                const chart = this.series.chart;
                                const targetNodeIds = ['id2', 'id3', 'id4'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('hover');
                                    }
                                }
                                )
                            },
                            mouseOut: function () {
                                this.setState('');
                                const chart = this.series.chart;
                                const targetNodeIds = ['id2', 'id3', 'id4'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('');
                                    }
                                }
                                )
                            },
                            click: function () {
                                toggleColors(['id1', 'id2', 'id3', 'id4'])
                            },
                        },

                    },
                    {
                        id: 'id2',
                        from: 'Yes',
                        to: 'Vibration',
                        weight: 10,
                        color: '#ed5565',
                    },
                    {
                        id: 'id3',
                        from: 'Yes',
                        to: 'Pneumatic Balloon',
                        weight: 10,
                        color: '#ed5565',

                    },
                    {
                        id: 'id4',
                        from: 'Yes',
                        to: 'Pneumatic Finger Band',
                        weight: 10,
                        color: '#ed5565',
                    },

                    ////////////
                    {
                        id: 'id5',
                        from: 'Self-control',
                        to: 'No',
                        weight: 30,
                        color: '#ffce54',
                        events: {
                            mouseOver: function () {
                                this.setState('hover');
                                const chart = this.series.chart;
                                const targetNodeIds = ['id6', 'id7', 'id8'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('hover');
                                    }
                                }
                                )
                            },
                            mouseOut: function () {
                                this.setState('');
                                const chart = this.series.chart;
                                const targetNodeIds = ['id6', 'id7', 'id8'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('');
                                    }
                                }
                                )
                            },
                            click: function () {
                                toggleColors(['id5', 'id6', 'id7', 'id8'])
                            },
                        },
                    },
                    {
                        id: 'id6',
                        from: 'No',
                        to: 'Pneumatic Finger Band',
                        weight: 10,
                        color: '#ffce54',
                    },

                    {
                        id: 'id7',
                        from: 'No',
                        to: 'EMS Actuation',
                        weight: 10,
                        color: '#ffce54',

                    },

                    {
                        id: 'id8',
                        from: 'No',
                        to: 'EMS Tingling Sensation',
                        weight: 10,
                        color: '#ffce54',
                    },
                    //////////
                    {
                        id: 'id9',
                        from: 'Physical intervention',
                        to: 'Yes',
                        weight: 20,
                        color: '#48cfad',
                        events: {
                            mouseOver: function () {
                                this.setState('hover');
                                const chart = this.series.chart;
                                const targetNodeIds = ['id10', 'id11'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('hover');
                                    }
                                }
                                )
                            },
                            mouseOut: function () {
                                this.setState('');
                                const chart = this.series.chart;
                                const targetNodeIds = ['id10', 'id11'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('');
                                    }
                                }
                                )
                            },

                            click: function () {
                                toggleColors(['id9', 'id10', 'id11'])
                            },
                        },
                    },
                    {
                        id: 'id10',
                        from: 'Yes',
                        to: 'Pneumatic Finger Band',
                        weight: 10,
                        color: '#48cfad',
                    },
                    {
                        id: 'id11',
                        from: 'Yes',
                        to: 'EMS Actuation',
                        weight: 10,
                        color: '#48cfad',
                    },
                    ////
                    ////////////
                    {
                        id: 'id12',
                        from: 'Physical intervention',
                        to: 'No',
                        weight: 30,
                        color: '#5d9cec',
                        events: {
                            mouseOver: function () {
                                this.setState('hover');
                                const chart = this.series.chart;
                                const targetNodeIds = ['id13', 'id14', 'id15'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('hover');
                                    }
                                }
                                )
                            },
                            mouseOut: function () {
                                this.setState('');
                                const chart = this.series.chart;
                                const targetNodeIds = ['id13', 'id14', 'id15'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('');
                                    }
                                }
                                )
                            },
                            click: function () {

                                toggleColors(['id12', 'id13', 'id14', 'id15'])

                            },
                        },
                    },

                    {
                        id: 'id13',
                        from: 'No',
                        to: 'Vibration',
                        weight: 10,
                        color: '#5d9cec',
                    },

                    {
                        id: 'id14',
                        from: 'No',
                        to: 'Pneumatic Balloon',
                        weight: 10,
                        color: '#5d9cec',

                    },

                    {
                        id: 'id15',
                        from: 'No',
                        to: 'EMS Tingling Sensation',
                        weight: 10,
                        color: '#5d9cec',

                    },
                    ////
                    {
                        id: 'id16',
                        from: 'Awareness',
                        to: 'Yes',
                        weight: 10,
                        color: '#ec87c0',

                        events: {
                            mouseOver: function () {
                                this.setState('hover');
                                const chart = this.series.chart;
                                const targetNodeIds = ['id17'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('hover');
                                    }
                                }
                                )
                            },
                            mouseOut: function () {
                                this.setState('');
                                const chart = this.series.chart;
                                const targetNodeIds = ['id17'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('');
                                    }
                                }
                                )
                            },
                            click: function () {

                                toggleColors(['id16', 'id17'])

                            },
                        },
                    },

                    {
                        id: 'id17',
                        from: 'Yes',
                        to: 'Pneumatic Finger Band',
                        weight: 10,
                        color: '#ec87c0',

                    },
                    {
                        id: 'id18',
                        from: 'Awareness',
                        to: 'No',
                        weight: 10,
                        color: '#ccd1d9',

                        events: {
                            mouseOver: function () {
                                this.setState('hover');
                                const chart = this.series.chart;
                                const targetNodeIds = ['id19'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('hover');
                                    }
                                }
                                )
                            },
                            mouseOut: function () {
                                this.setState('');
                                const chart = this.series.chart;
                                const targetNodeIds = ['id19'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('');
                                    }
                                }
                                )
                            },
                            click: function () {

                                toggleColors(['id18', 'id19'])

                            },
                        },

                    },

                    {

                        id: 'id19',
                        from: 'No',
                        to: 'Pneumatic Finger Band',
                        weight: 10,
                        color: '#ccd1d9',

                    },
                    {
                        id: 'id20',
                        from: 'Distraction',
                        to: 'Yes',
                        weight: 10,
                        color: '#F6FA70',

                        events: {
                            mouseOver: function () {
                                // Set hover state for this node
                                this.setState('hover');
                                // Find the related "to" nodes ('id2', 'id3', 'id4') and set their hover states
                                const chart = this.series.chart;
                                const targetNodeIds = ['id21'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('hover');
                                    }
                                }
                                )
                            },
                            mouseOut: function () {
                                // Reset to normal state on mouse out
                                this.setState('');
                                // Find the related "to" nodes ('id2', 'id3', 'id4') and reset their states
                                const chart = this.series.chart;
                                const targetNodeIds = ['id21'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('');
                                    }
                                }
                                )
                            },
                            click: function () {

                                toggleColors(['id20', 'id21'])

                            },
                        },
                    },

                    {
                        id: 'id21',
                        from: 'Yes',
                        to: 'Pneumatic Balloon',
                        weight: 10,
                        color: '#F6FA70',

                    },
                    {
                        id: 'id22',
                        from: 'Distraction',
                        to: 'No',
                        weight: 10,
                        color: '#a0d468',

                        events: {
                            mouseOver: function () {
                                // Set hover state for this node
                                this.setState('hover');
                                // Find the related "to" nodes ('id2', 'id3', 'id4') and set their hover states
                                const chart = this.series.chart;
                                const targetNodeIds = ['id23'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('hover');
                                    }
                                }
                                )
                            },
                            mouseOut: function () {
                                // Reset to normal state on mouse out
                                this.setState('');
                                // Find the related "to" nodes ('id2', 'id3', 'id4') and reset their states
                                const chart = this.series.chart;
                                const targetNodeIds = ['id23'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('');
                                    }
                                }
                                )
                            },
                            click: function () {

                                toggleColors(['id22', 'id23'])

                            },
                        },
                    },

                    {

                        id: 'id23',
                        from: 'No',
                        to: 'Vibration',
                        weight: 10,
                        color: '#a0d468',

                    },
                    {
                        id: 'id24',
                        from: 'Want Strong Feedback',
                        to: 'Yes',
                        weight: 10,
                        color: '#656d78',

                        events: {
                            mouseOver: function () {
                                // Set hover state for this node
                                this.setState('hover');
                                // Find the related "to" nodes ('id2', 'id3', 'id4') and set their hover states
                                const chart = this.series.chart;
                                const targetNodeIds = ['id25'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('hover');
                                    }
                                }
                                )
                            },
                            mouseOut: function () {
                                // Reset to normal state on mouse out
                                this.setState('');
                                // Find the related "to" nodes ('id2', 'id3', 'id4') and reset their states
                                const chart = this.series.chart;
                                const targetNodeIds = ['id25'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('');
                                    }
                                }
                                )
                            },
                            click: function () {

                                toggleColors(['id24', 'id25'])

                            },
                        },
                    },

                    {

                        id: 'id25',
                        from: 'Yes',
                        to: 'EMS Actuation',
                        weight: 10,
                        color: '#656d78',

                    },
                    {
                        id: 'id26',
                        from: 'Want Strong Feedback',
                        to: 'No',
                        weight: 10,
                        color: '#A633AA',

                        events: {
                            mouseOver: function () {
                                // Set hover state for this node
                                this.setState('hover');
                                // Find the related "to" nodes ('id2', 'id3', 'id4') and set their hover states
                                const chart = this.series.chart;
                                const targetNodeIds = ['id27'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('hover');
                                    }
                                }
                                )
                            },
                            mouseOut: function () {
                                // Reset to normal state on mouse out
                                this.setState('');
                                // Find the related "to" nodes ('id2', 'id3', 'id4') and reset their states
                                const chart = this.series.chart;
                                const targetNodeIds = ['id27'];
                                targetNodeIds.forEach(targetId => {
                                    const toNode = chart.series[0].points.find(point => point.id === targetId);
                                    if (toNode) {
                                        toNode.setState('');
                                    }
                                }
                                )
                            },
                            click: function (event) {

                                toggleColors(['id26', 'id27'])
                            }
                        },
                    },
                    {

                        id: 'id27',
                        from: 'No',
                        to: 'Pneumatic Finger Band',
                        weight: 10,
                        color: '#A633AA',
                    },

                ],
                type: 'sankey',
                name: 'Sankey demo series'
            }


            ],


        },
        );
        // Store original colors when the chart is rendered
        chart.series[0].points.forEach(point => {
            originalColors[point.id] = point.color;
        });
        chart.update({
            chart: {
                events: {
                    render: function () {
                        console.log("test");
                        renderer = chart.renderer,
                            width = 30;

                        // Delete groups
                        if (chart.customImgGroup) {
                            chart.customImgGroup.destroy();
                        }

                        // Create groups
                        chart.customImgGroup = renderer.g('customImgGroup').add();

                        // Render texts
                        chart.renderer.image('img/vibration.jpg', chart.plotLeft + 30 + chart.plotSizeX - width, 67, 40, 40)
                            .add(chart.customImgGroup);

                                                // Render texts
                                                chart.renderer.image('img/balloon.jpg', chart.plotLeft + 30 + chart.plotSizeX - width, 120, 40, 40)
                            .add(chart.customImgGroup);
                                            // Render texts
                                            chart.renderer.image('img/bending.jpg', chart.plotLeft + 30 + chart.plotSizeX - width, 210, 40, 40)
                             .add(chart.customImgGroup);
                            //                 // Render texts
                                             chart.renderer.image('img/actuation.jpg', chart.plotLeft + 30 + chart.plotSizeX - width, 295, 40, 40)
                             .add(chart.customImgGroup);
                            //                 // Render texts
                                            chart.renderer.image('img/stimulation.jpg', chart.plotLeft + 30 + chart.plotSizeX - width, 360, 40, 40)
                             .add(chart.customImgGroup);
                    }
                }
            }
        });
        // Toggle colors on click
        function toggleColors(nodeIds) {
            nodeIds.forEach(targetId => {
                const toNode = chart.series[0].points.find(point => point.id === targetId);
                if (toNode) {
                    const currentColor = toNode.color;
                    const originalColor = originalColors[targetId];

                    if (currentColor === 'Blue') {
                        toNode.update({ color: originalColor });
                    } else {
                        toNode.update({ color: 'Blue' });
                    }
                }
            });
        }
    </script>

</body>

</html>